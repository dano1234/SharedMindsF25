<!doctype html>
<html>

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Node + Replicate Desktop GUI</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 24px;
        }

        .row {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        input[type="text"] {
            flex: 1;
            font-size: 16px;
            padding: 10px 12px;
        }

        button {
            padding: 10px 14px;
            font-size: 16px;
        }
    </style>
</head>

<body>
    <h1>Node + Replicate GUI</h1>
    <div class="row">
        <input id="prompt" type="text" placeholder="Describe an image..." />
        <button id="go">Generate</button>
    </div>
    <div id="error"></div>
    <canvas id="canvas" width="1024" height="1024" style="margin-top:16px; border:1px solid #ccc"></canvas>

    <script>
        const promptEl = document.getElementById('prompt');
        const go = document.getElementById('go');
        const errorEl = document.getElementById('error');
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');

        function drawImageFromUrl(url) {
            const img = new Image();
            img.onload = () => {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                const scale = Math.min(canvas.width / img.width, canvas.height / img.height);
                const w = img.width * scale;
                const h = img.height * scale;
                const x = (canvas.width - w) / 2;
                const y = (canvas.height - h) / 2;
                ctx.drawImage(img, x, y, w, h);
            };
            img.src = url;
        }
        async function askReplicate() {

            let options = {
                prompt: promptEl.value
            }
            const data = await window.replicateAPI.generate({ model: "bytedance/seedance-1-pro", prompt: promptEl.value });//in main.js
            console.log("data", data);
            const url = data.output[0];
            if (url) drawImageFromUrl(url);
        }
        go.addEventListener('click', askReplicate);
        promptEl.addEventListener('keydown', (e) => { if (e.key === 'Enter') askReplicate(); });
    </script>
</body>

</html>